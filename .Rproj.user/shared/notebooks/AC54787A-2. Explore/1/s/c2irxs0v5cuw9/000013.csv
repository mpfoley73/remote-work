"0","plot_prop <- function(x, grp_var, grp_title) {"
"0","  grp_var <- ensym(grp_var)"
"0","  x %>%"
"0","    filter(struggle != ""Other"") %>%"
"0","    count(struggle, !!grp_var) %>%"
"0","    group_by(!!grp_var) %>%"
"0","    mutate(pct = n / sum(n)) %>%"
"0","    ggplot(aes(x = fct_rev(!!grp_var), y = pct)) +"
"0","    geom_col(fill = ""lightsteelblue"", color = ""steelblue"") +"
"0","    geom_text(aes(label = n), size = 3, nudge_y = -.03) +"
"0","    scale_y_continuous(labels = scales::percent_format()) +"
"0","    coord_flip() +"
"0","    theme_light() +"
"0","    theme(strip.background = element_rect(fill = ""gray90""),"
"0","          strip.text = element_text(color = ""steelblue"")) +"
"0","    labs(title = grp_title, "
"0","         subtitle = codebook %>% filter(item == grp_var) %>% pull(desc),"
"0","         y = NULL, x = NULL, fill = NULL) +"
"0","    facet_wrap(facets = vars(struggle))"
"0","}"
